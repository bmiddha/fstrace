// Code generated by bpf2go; DO NOT EDIT.
//go:build mips || mips64 || ppc64 || s390x

package main

import (
	"bytes"
	_ "embed"
	"fmt"
	"io"

	"github.com/cilium/ebpf"
)

type vfsEventT struct {
	Type uint32
	Pid  uint32
	Cgid uint64
	Str  [4096]int8
}

type vfsSimpleBuf struct{ Buf [32768]uint8 }

// loadVfs returns the embedded CollectionSpec for vfs.
func loadVfs() (*ebpf.CollectionSpec, error) {
	reader := bytes.NewReader(_VfsBytes)
	spec, err := ebpf.LoadCollectionSpecFromReader(reader)
	if err != nil {
		return nil, fmt.Errorf("can't load vfs: %w", err)
	}

	return spec, err
}

// loadVfsObjects loads vfs and converts it into a struct.
//
// The following types are suitable as obj argument:
//
//	*vfsObjects
//	*vfsPrograms
//	*vfsMaps
//
// See ebpf.CollectionSpec.LoadAndAssign documentation for details.
func loadVfsObjects(obj interface{}, opts *ebpf.CollectionOptions) error {
	spec, err := loadVfs()
	if err != nil {
		return err
	}

	return spec.LoadAndAssign(obj, opts)
}

// vfsSpecs contains maps and programs before they are loaded into the kernel.
//
// It can be passed ebpf.CollectionSpec.Assign.
type vfsSpecs struct {
	vfsProgramSpecs
	vfsMapSpecs
}

// vfsSpecs contains programs before they are loaded into the kernel.
//
// It can be passed ebpf.CollectionSpec.Assign.
type vfsProgramSpecs struct {
	RawTracepointSysEnter *ebpf.ProgramSpec `ebpf:"raw_tracepoint_sys_enter"`
	RawTracepointSysExit  *ebpf.ProgramSpec `ebpf:"raw_tracepoint_sys_exit"`
}

// vfsMapSpecs contains maps before they are loaded into the kernel.
//
// It can be passed ebpf.CollectionSpec.Assign.
type vfsMapSpecs struct {
	BufsOff       *ebpf.MapSpec `ebpf:"bufs_off"`
	Events        *ebpf.MapSpec `ebpf:"events"`
	TmpBufMap     *ebpf.MapSpec `ebpf:"tmp_buf_map"`
	TmpStorageMap *ebpf.MapSpec `ebpf:"tmp_storage_map"`
}

// vfsObjects contains all objects after they have been loaded into the kernel.
//
// It can be passed to loadVfsObjects or ebpf.CollectionSpec.LoadAndAssign.
type vfsObjects struct {
	vfsPrograms
	vfsMaps
}

func (o *vfsObjects) Close() error {
	return _VfsClose(
		&o.vfsPrograms,
		&o.vfsMaps,
	)
}

// vfsMaps contains all maps after they have been loaded into the kernel.
//
// It can be passed to loadVfsObjects or ebpf.CollectionSpec.LoadAndAssign.
type vfsMaps struct {
	BufsOff       *ebpf.Map `ebpf:"bufs_off"`
	Events        *ebpf.Map `ebpf:"events"`
	TmpBufMap     *ebpf.Map `ebpf:"tmp_buf_map"`
	TmpStorageMap *ebpf.Map `ebpf:"tmp_storage_map"`
}

func (m *vfsMaps) Close() error {
	return _VfsClose(
		m.BufsOff,
		m.Events,
		m.TmpBufMap,
		m.TmpStorageMap,
	)
}

// vfsPrograms contains all programs after they have been loaded into the kernel.
//
// It can be passed to loadVfsObjects or ebpf.CollectionSpec.LoadAndAssign.
type vfsPrograms struct {
	RawTracepointSysEnter *ebpf.Program `ebpf:"raw_tracepoint_sys_enter"`
	RawTracepointSysExit  *ebpf.Program `ebpf:"raw_tracepoint_sys_exit"`
}

func (p *vfsPrograms) Close() error {
	return _VfsClose(
		p.RawTracepointSysEnter,
		p.RawTracepointSysExit,
	)
}

func _VfsClose(closers ...io.Closer) error {
	for _, closer := range closers {
		if err := closer.Close(); err != nil {
			return err
		}
	}
	return nil
}

// Do not access this directly.
//
//go:embed vfs_bpfeb.o
var _VfsBytes []byte
